{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"en/","title":"\u5e8f\u8a00","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"en/#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"en/#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"en/env/","title":"\u5f00\u53d1\u73af\u5883\u914d\u7f6e","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c\u73af\u5883\u8bbe\u8ba1\u5728 Linux \u73af\u5883\u4e2d\uff0c\u672c\u6587\u6863\u4e3b\u8981\u9762\u5411 Ubuntu / Debian \u53d1\u884c\u7248\u64b0\u5199\uff0c\u6211\u4eec\u5f3a\u70c8\u63a8\u8350\u60a8\u4f7f\u7528 Ubuntu / Debian \u53d1\u884c\u7248\uff0c\u4ee5\u6b64\u51cf\u5c11\u53ef\u80fd\u9047\u5230\u7684\u95ee\u9898\u3002</p>"},{"location":"en/env/#linux","title":"\u642d\u5efa Linux \u865a\u62df\u73af\u5883","text":"<p>\u5982\u679c\u4f60\u4f7f\u7528 Linux \u7269\u7406\u673a\u4f5c\u4e3a\u5f00\u53d1\u73af\u5883\uff0c\u8bf7\u76f4\u63a5\u53c2\u8003 Linux \u73af\u5883\u914d\u7f6e \u7ee7\u7eed\u914d\u7f6e\u73af\u5883\u3002</p> <p>\u5982\u679c\u4f60\u4f7f\u7528 Windows \u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\uff1a</p> <ul> <li> <p>\u57fa\u4e8e VirtualBox \u7684\u865a\u62df\u673a\u73af\u5883</p> </li> <li> <p>\u57fa\u4e8e VMWare \u7684\u865a\u62df\u673a\u73af\u5883</p> </li> <li> <p>\u57fa\u4e8e WSL2 \u7684\u865a\u62df\u673a\u73af\u5883 \uff08\u5b9e\u9a8c\u4e2d\uff09</p> </li> </ul> <p>\u5982\u679c\u4f60\u4f7f\u7528 macOS \u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f60\u53ef\u4ee5\u53c2\u8003\uff1a</p> <ul> <li>\u57fa\u4e8e VirtualBox \u7684\u865a\u62df\u673a\u73af\u5883</li> </ul>"},{"location":"en/env/#_2","title":"\u642d\u5efa\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c\u5f00\u53d1\u73af\u5883","text":"<p>\u5f53\u4f60\u5b8c\u6210 Linux \u865a\u62df\u673a\u7684\u73af\u5883\u914d\u7f6e\u540e\uff0c\u8bf7\u7ee7\u7eed\u53c2\u8003 Linux \u73af\u5883\u914d\u7f6e \u914d\u7f6e\u5f00\u53d1\u73af\u5883\u3002</p>"},{"location":"en/env/gdb/","title":"GDB","text":""},{"location":"en/env/linux-setup/","title":"\u5728 Linux \u73af\u5883\u4e2d\u914d\u7f6e\u64cd\u4f5c\u7cfb\u7edf\u5f00\u53d1\u73af\u5883","text":"<p>\u5230\u8fd9\u4e00\u6b65\u65f6\uff0c\u8bf7\u786e\u4fdd\u4f60\u5df2\u7ecf\u914d\u7f6e\u597d Linux \u73af\u5883\uff0c\u4e0d\u7ba1\u662f\u7269\u7406\u673a\u73af\u5883\u6216\u662f Windows / macOS \u7cfb\u7edf\u5185\u7684\u865a\u62df\u673a</p>"},{"location":"en/env/linux-setup/#risc-v","title":"\u5b89\u88c5 RISC-V \u5de5\u5177\u94fe","text":""},{"location":"en/env/macos-virtualbox/","title":"macOS VirtualBox","text":""},{"location":"en/env/windows-virtualbox/","title":"Windows VirtualBox","text":""},{"location":"en/env/windows-vmware/","title":"Windows VMWare WorkStation","text":""},{"location":"en/env/windows-wsl/","title":"Windows WSL","text":""},{"location":"en/lab/lab1/","title":"Lab1","text":""},{"location":"en/qrh/nav/","title":"\u5feb\u901f\u53c2\u8003\u624b\u518c","text":"<p>\u672c\u624b\u518c\u4f1a\u8bb0\u5f55\u4f60\u5728\u8fdb\u884c\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c\u4e2d\u53ef\u80fd\u4f1a\u9047\u5230\u7684\u95ee\u9898\uff0c\u6216\u8005\u9700\u8981\u5b66\u4e60\u7684\u524d\u7f6e\u77e5\u8bc6</p> <ul> <li>GDB \u6559\u7a0b</li> </ul>"},{"location":"zh/","title":"\u5e8f\u8a00","text":"<p>\u5728\u8fd9\u91cc\u67e5\u770b\u5b8c\u6574\u6587\u6863 mkdocs.org.</p>"},{"location":"zh/#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"zh/#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"zh/env/","title":"\u642d\u5efa Linux \u73af\u5883","text":"<p>GNU/Linux \u662f\u4e00\u79cd\u81ea\u7531\u548c\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\uff0c\u800c Ubuntu \u662f\u4e00\u4e2a\u57fa\u4e8e Debian \u7684 GNU/Linux \u53d1\u884c\u7248\u3002</p> <p>\u5728\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c\u8bfe\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 Ubuntu 24.04 LTS \u4f5c\u4e3a\u6807\u51c6\u7684\u5b9e\u9a8c\u73af\u5883\u3002</p> <p>Warning</p> <p>\u5982\u679c\u4f60\u5df2\u7ecf\u5728\u4f7f\u7528\u5176\u4ed6 Linux \u53d1\u884c\u7248\uff0c\u8bf7\u786e\u4fdd\u4f60\u719f\u6089\u4f60\u6240\u4f7f\u7528\u7684\u53d1\u884c\u7248\u4e0e Ubuntu \u7684\u533a\u522b\uff0c\u5982\u5305\u7ba1\u7406\u5668\u3002\u5e76\u786e\u4fdd\u4f60\u6709\u80fd\u529b\u81ea\u5df1\u89e3\u51b3\u53d1\u884c\u7248\u4e0d\u4e00\u81f4\u5e26\u6765\u7684\u73af\u5883\u95ee\u9898\u3002</p> <p>\u5982\u679c\u4f60\u5728\u4f7f\u7528\u4f4e\u7248\u672c\u7684 Ubuntu \uff0c\u5982 18.04 LTS\uff0c\u5efa\u8bae\u4f60\u4f7f\u7528 Ubuntu 24.04 LTS \u4ee5\u907f\u514d gcc/qemu \u7248\u672c\u8fc7\u4f4e\u7684\u95ee\u9898\u3002</p> <p>\u5982\u679c\u4f60\u4f7f\u7528 Windows / macOS \u7cfb\u7edf\uff0c\u8bf7\u4f7f\u7528\u865a\u62df\u673a\u8f6f\u4ef6\u8fd0\u884c Ubuntu \u7cfb\u7edf\uff0c\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4efd\u5df2\u7ecf\u5b89\u88c5\u597d\u73af\u5883\u7684 Ubuntu 24.04 LTS \u865a\u62df\u673a\u955c\u50cf\uff0c\u8bf7\u53c2\u7167 \u865a\u62df\u673a\u8bbe\u7f6e \u4e00\u8282\u8fdb\u884c\u8bbe\u7f6e\u3002</p> <p>\u6211\u4eec\u4e5f\u63d0\u4f9b\u4e86\u57fa\u4e8e Windows WSL 2.0 \u7684\u65b9\u6848\uff0c\u8bf7\u53c2\u8003 \u865a\u62df\u673a\u8bbe\u7f6e \u8bbe\u7f6e\u3002</p>"},{"location":"zh/env/dedicated-toolchains/","title":"\u4f7f\u7528\u81ea\u7f16\u8bd1\u7684\u5de5\u5177\u94fe","text":"<p>Warning</p> <p>\u5982\u6709\u53ef\u80fd\uff0c\u8bf7\u5c3d\u91cf\u4f7f\u7528\u53d1\u884c\u7248\u81ea\u5e26\u7684\u5de5\u5177\u94fe/QEMU \u7b49\u3002</p> <p>\u5982\u679c\u4f60\u5728\u4f7f\u7528\u53d1\u884c\u7248\u7684 gcc/qemu \u65f6\u9047\u5230\u95ee\u9898\uff0c\u5e76\u4e14\u4f60\u786e\u5b9a\u662f\u73af\u5883\u4e0d\u4e00\u81f4\u5bfc\u81f4\u7684\u95ee\u9898\uff0c\u4f60\u53ef\u4ee5\u53c2\u7167\u8be5\u6587\u6863\u4ece\u96f6\u7f16\u8bd1\u6574\u4e2a\u5de5\u5177\u94fe\u3002</p>"},{"location":"zh/env/dedicated-toolchains/#gcc","title":"gcc","text":"<p>\u53c2\u7167 https://github.com/riscv-collab/riscv-gnu-toolchain\uff1a</p> <pre><code>$ sudo -i\n$ git clone https://github.com/riscv/riscv-gnu-toolchain\n$ sudo apt-get install autoconf automake autotools-dev curl python3 python3-pip libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev ninja-build git cmake libglib2.0-dev libslirp-dev\n$ mkdir -p /opt/riscv\n$ ./configure --prefix=/opt/riscv\n$ make\n</code></pre>"},{"location":"zh/env/gdb/","title":"GDB","text":""},{"location":"zh/env/git/","title":"Git","text":"<p>\u50cf Git \u8fd9\u6837\u7684\u7248\u672c\u63a7\u5236\u7cfb\u7edf\u663e\u7740\u5f71\u54cd\u4e86\u73b0\u4ee3\u8f6f\u4ef6\u5f00\u53d1\uff0c\u8fd9\u9700\u8981\u5408\u4f5c\u548c\u5feb\u901f\u8fed\u4ee3\u3002 \u4f60\u4eec\u5e94\u8be5\u5728\u6b64\u524d\u7684\u8bf8\u591a\u8bfe\u7a0b\u4e2d\u4e0e Git \u4ea4\u624b\u8fc7\uff0c\u5728\u63a5\u4e0b\u6765\u7684\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u5c06\u4f1a\u4f7f\u7528 GitLab\u3002</p>"},{"location":"zh/env/helloworld/","title":"\u8fd0\u884c Hello World","text":""},{"location":"zh/env/helloworld/#_1","title":"\u7f16\u8bd1\u4e0e\u8fd0\u884c\u5185\u6838","text":"<p>\u514b\u9686\u5185\u6838\u4ee3\u7801\u548c\u7528\u6237\u7a0b\u5e8f\u4ee3\u7801\u4ed3\u5e93\uff1a</p> <pre><code>~/Desktop&gt; git clone https://github.com/yuk1i/uCore-VisionFive2\n~/Desktop&gt; cd uCore-VisionFive2\n~/Desktop/uCore-VisionFive2&gt; git clone https://github.com/yuk1i/uCore-VF2-user.git user\n</code></pre> <p>\u7f16\u8bd1\u7528\u6237\u7a0b\u5e8f\uff1a</p> <pre><code>make CH_TESTS=usershell user\n</code></pre> <p>\u7f16\u8bd1\u5185\u6838:</p> <pre><code>make\n</code></pre> <p>\u5728 QEMU \u4e2d\u8fd0\u884c\u5185\u6838\uff1a</p> <pre><code>make run\n</code></pre> <p>\u5982\u679c\u4e00\u5207\u6b63\u5e38\uff0c\u4f60\u5c06\u80fd\u591f\u770b\u5230\uff1a</p> <pre><code>OpenSBI v1.3\n   ____                    _____ ____ _____\n  / __ \\                  / ____|  _ \\_   _|\n | |  | |_ __   ___ _ __ | (___ | |_) || |\n | |  | | '_ \\ / _ \\ '_ \\ \\___ \\|  _ &lt; | |\n | |__| | |_) |  __/ | | |____) | |_) || |_\n  \\____/| .__/ \\___|_| |_|_____/|___/_____|\n        | |\n        |_|\n\nPlatform Name             : riscv-virtio,qemu\nPlatform Features         : medeleg\nPlatform HART Count       : 1\nPlatform IPI Device       : aclint-mswi\nPlatform Timer Device     : aclint-mtimer @ 10000000Hz\nPlatform Console Device   : uart8250\nPlatform HSM Device       : ---\nPlatform PMU Device       : ---\nPlatform Reboot Device    : sifive_test\nPlatform Shutdown Device  : sifive_test\nPlatform Suspend Device   : ---\nPlatform CPPC Device      : ---\nFirmware Base             : 0x80000000\nFirmware Size             : 322 KB\nFirmware RW Offset        : 0x40000\nFirmware RW Size          : 66 KB\nFirmware Heap Offset      : 0x48000\nFirmware Heap Size        : 34 KB (total), 2 KB (reserved), 9 KB (used), 22 KB (free)\nFirmware Scratch Size     : 4096 B (total), 760 B (used), 3336 B (free)\nRuntime SBI Version       : 1.0\n\nDomain0 Name              : root\nDomain0 Boot HART         : 0\nDomain0 HARTs             : 0*\nDomain0 Region00          : 0x0000000002000000-0x000000000200ffff M: (I,R,W) S/U: ()\nDomain0 Region01          : 0x0000000080040000-0x000000008005ffff M: (R,W) S/U: ()\nDomain0 Region02          : 0x0000000080000000-0x000000008003ffff M: (R,X) S/U: ()\nDomain0 Region03          : 0x0000000000000000-0xffffffffffffffff M: (R,W,X) S/U: (R,W,X)\nDomain0 Next Address      : 0x0000000080200000\nDomain0 Next Arg1         : 0x0000000087e00000\nDomain0 Next Mode         : S-mode\nDomain0 SysReset          : yes\nDomain0 SysSuspend        : yes\n\nBoot HART ID              : 0\nBoot HART Domain          : root\nBoot HART Priv Version    : v1.12\nBoot HART Base ISA        : rv64imafdch\nBoot HART ISA Extensions  : time,sstc\nBoot HART PMP Count       : 16\nBoot HART PMP Granularity : 4\nBoot HART PMP Address Bits: 54\nBoot HART MHPM Count      : 16\nBoot HART MIDELEG         : 0x0000000000001666\nBoot HART MEDELEG         : 0x0000000000f0b509\netext: 0x0000000080205000\nKernel is initializing...\nproc_init done!\ntrap_init done!\nkvm_init done!\napplist:\n        usershell\nloader done!\ntimer_init done!\nC user shell\n&gt;&gt; \n</code></pre>"},{"location":"zh/env/qemu/","title":"Qemu","text":"<p>qemu\u662f\u4e00\u4e2a\u786c\u4ef6\u6a21\u62df\u5668\uff0c\u53ef\u4ee5\u6a21\u62df\u4e0d\u540c\u67b6\u6784\u7684CPU\u3002 \u5b83\u751a\u81f3\u53ef\u4ee5\u6a21\u62df\u4e0d\u540c\u67b6\u6784\u7684 CPU\uff0c\u6bd4\u5982\u8bf4\u5728\u4f7f\u7528 Intel X86 \u7684 CPU \u7684\u7535\u8111\u4e2d\u6a21\u62df\u51fa\u4e00\u4e2a ARM \u7684\u7535\u8111\u6216 RISC-V \u7684\u7535\u8111\u3002 qemu \u540c\u65f6\u4e5f\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u865a\u62df\u673a\uff0c\u7ed9\u5b83\u4e00\u4e2a\u786c\u76d8\u955c\u50cf\u5c31\u53ef\u4ee5\u542f\u52a8\u4e00\u4e2a\u865a\u62df\u673a\uff0c\u5e76\u4e14\u53ef\u4ee5\u5b9a\u5236\u865a\u62df\u673a\u7684\u914d\u7f6e\uff0c\u6bd4\u5982\u8981\u4f7f\u7528\u7684CPU \u3001\u663e\u5361\u3001\u7f51\u7edc\u914d\u7f6e\u7b49\uff0c\u6307\u5b9a\u76f8\u5e94\u7684\u547d\u4ee4\u884c\u53c2\u6570\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>Qemu\u652f\u6301\u8bb8\u591a\u683c\u5f0f\u7684\u78c1\u76d8\u955c\u50cf\uff0c\u5305\u62ec VirtualBox \u521b\u5efa\u7684\u78c1\u76d8\u955c\u50cf\u6587\u4ef6\u3002 \u5b83\u540c\u65f6\u4e5f\u63d0\u4f9b\u4e00\u4e2a\u521b\u5efa\u548c\u7ba1\u7406\u78c1\u76d8\u955c\u50cf\u7684\u5de5\u5177qemu-img\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u67e5\u770b QEMU \u6240\u4f7f\u7528\u7684\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u76f4\u63a5\u67e5\u770b\u5176\u6587\u6863\u5373\u53ef\u3002</p> <ul> <li>\u5728\u7ebf\u6587\u6863\uff1ahttps://www.qemu.org/docs/master/about/index.html</li> <li>\u672c\u5730\u6587\u6863\uff1a<code>qemu-system-x86_64 --help</code></li> </ul> <p>\u6211\u4eec\u9700\u8981\u4f7f\u7528 Qemu 5.0.0 \u7248\u672c\u8fdb\u884c\u5b9e\u9a8c\uff0c\u800c\u5f88\u591a Linux \u53d1\u884c\u7248\u7684\u8f6f\u4ef6\u5305\u7ba1\u7406\u5668\u9ed8\u8ba4\u8f6f\u4ef6\u6e90\u4e2d\u7684 Qemu\u7248\u672c\u8fc7\u4f4e\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u4ece\u6e90\u7801\u624b\u52a8\u7f16\u8bd1\u5b89\u88c5 Qemu \u6a21\u62df\u5668\u3002</p> example<pre><code># \u5b89\u88c5\u7f16\u8bd1\u6240\u9700\u7684\u4f9d\u8d56\u5305\nsudo apt install autoconf automake autotools-dev curl libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev pkg-config libglib2.0-dev libpixman-1-dev git tmux python3 python3-pip\n</code></pre> <pre><code>int main() {\n    int a = 1;\n} \n</code></pre>"},{"location":"zh/env/setup/","title":"\u5728 Ubuntu \u4e2d\u914d\u7f6e\u5f00\u53d1\u73af\u5883","text":"<p>\u5230\u8fd9\u4e00\u6b65\u65f6\uff0c\u8bf7\u786e\u4fdd\u4f60\u5df2\u7ecf\u914d\u7f6e\u597d Linux \u73af\u5883\uff0c\u80fd\u6253\u5f00\u4e00\u4e2a Terminal \u6267\u884c\u547d\u4ee4\u3002</p> <p>Warning</p> <p>\u8bf7\u4f7f\u7528\u5c3d\u53ef\u80fd\u65b0\u7684\u53d1\u884c\u7248\u672c\u3002\u4ee5\u4e0b\u4ee3\u7801\u5747\u5df2 Ubuntu 24.04 LTS \u4e3a\u57fa\u51c6\u3002</p>"},{"location":"zh/env/setup/#gcc-qemu","title":"\u5b89\u88c5 gcc \u5de5\u5177\u94fe\u4ee5\u53ca QEMU","text":"<p>\u4f7f\u7528\u5305\u7ba1\u7406\u5668 apt \u5b89\u88c5\u4f9d\u8d56\uff1a</p> <pre><code>sudo apt update &amp;&amp; sudo apt install gcc-riscv64-unknown-elf qemu-system-misc git make cmake python3-pip elfutils gdb-multiarch\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8fd0\u884c <code>riscv64-unknown-elf-gcc --version</code>\uff0c<code>qemu-system-riscv64 --version</code> \u548c <code>gdb-multiarch --version</code> \u68c0\u67e5\u7248\u672c\uff1a</p> <pre><code>$ riscv64-unknown-elf-gcc --version\nriscv64-unknown-elf-gcc (13.2.0-11ubuntu1+12) 13.2.0\nCopyright (C) 2023 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\n$ qemu-system-riscv64 --version\nQEMU emulator version 8.2.2 (Debian 1:8.2.2+ds-0ubuntu1)\nCopyright (c) 2003-2023 Fabrice Bellard and the QEMU Project developers\n\n$ gdb-multiarch --version\nGNU gdb (Ubuntu 15.0.50.20240403-0ubuntu1) 15.0.50.20240403-git\nCopyright (C) 2024 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n</code></pre> <p>\u8bf7\u786e\u4fdd gcc \u7248\u672c &gt;= 13.0.0\uff0cqemu-system-riscv64 \u7248\u672c &gt;= 8.0.0\uff0cgdb-multiarch \u7248\u672c &gt;= 15</p> <p>\u5982\u679c\u4f60\u5747\u5b89\u88c5\u597d\u4e86\u4ee5\u4e0a\u4f9d\u8d56\uff0c\u8bf7\u5c1d\u8bd5\u7f16\u8bd1\u5e76\u8fd0\u884c Hello World</p>"},{"location":"zh/env/vm-setup/","title":"\u865a\u62df\u673a/WSL \u8bbe\u7f6e","text":""},{"location":"zh/env/vm-setup/#windows","title":"Windows \u865a\u62df\u673a\u8bbe\u7f6e","text":""},{"location":"zh/env/vm-setup/#windows-wsl","title":"Windows WSL \u8bbe\u7f6e","text":""},{"location":"zh/env/vm-setup/#macos","title":"macOS \u865a\u62df\u673a\u8bbe\u7f6e","text":""},{"location":"zh/lab/lab1/","title":"Lab1 - C \u8bed\u8a00\u57fa\u7840","text":"<p>\u5728\u672c\u6b21\u5b9e\u9a8c\u4e2d\uff0c\u6211\u4eec\u5c06\u5b66\u4e60\u57fa\u672c\u7684 C \u8bed\u8a00\u7f16\u7a0b\u548c\u9759\u6001\u94fe\u63a5\u3002</p>"},{"location":"zh/lab/lab1/#_1","title":"\u7c7b\u578b","text":"<p>\u5728 C \u8bed\u8a00\u4e2d\uff0c\u6574\u6570\u7c7b\u578b\u6709 long, int, short, char \u7b49\u3002 \u5728\u4e3b\u6d41\u7684\u67b6\u6784\u4e0a\uff0cint \u7c7b\u578b\u4e3a 32 \u4f4d\u957f\uff0c\u800c long \u7c7b\u578b\u4e3a 64 \u4f4d\u957f\u3002 \u4f46\u662f\uff0c\u4e3a\u4e86\u907f\u514d\u7f16\u8bd1\u76ee\u6807\u67b6\u6784\u7684\u4e0d\u540c\u800c\u5bfc\u81f4 long\u3001int \u7b49\u7c7b\u578b\u5b9e\u9645\u957f\u5ea6\u4e0e\u6211\u4eec\u9884\u60f3\u7684\u4e0d\u4e00\u81f4\uff0c\u5728\u7cfb\u7edf\u7f16\u7a0b\u4e2d\uff0c\u6211\u4eec\u4f1a\u4f7f\u7528\u5b9a\u957f\u7684\u6574\u5f62\uff0c\u5982 uint64_t, int32_t \u7b49\u3002 \u5728\u4e0d\u540c\u7684\u7f16\u8bd1\u5668\u73af\u5883\u4e0b\uff0c\u4f7f\u7528\u8fd9\u4e00\u4e9b\u7c7b\u578b\u4fdd\u8bc1\u4e86\u5b83\u4eec\u7edd\u5bf9\u662f\u6307\u5b9a\u957f\u5ea6\u7684\u3002</p> <p>\u4f8b\u5982\uff0c\u5728 <code>os/types.h</code> \u4e2d\uff1a</p> <pre><code>typedef unsigned int uint;\ntypedef unsigned short ushort;\ntypedef unsigned char uchar;\ntypedef unsigned char uint8;\ntypedef unsigned short uint16;\ntypedef unsigned int uint32;\ntypedef unsigned long uint64;\n</code></pre> <p>\u6211\u4eec\u5b9a\u4e49\u4e86 <code>uint64</code>, <code>uint32</code> \u7b49\u7c7b\u578b\u5206\u522b\u4e3a <code>unsigned long</code> \u548c <code>unsigned int</code>\u3002 \u7531\u4e8e\u6211\u4eec\u9762\u5411 riscv64 \u67b6\u6784\u8fdb\u884c\u7f16\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u4fdd\u5b83\u4eec\u662f 64 / 32 \u4f4d\u7684\u3002</p>"},{"location":"zh/lab/lab1/#_2","title":"\u7a7a\u95f4\u5206\u914d","text":"<p>\u5f53\u6211\u4eec\u5b9a\u4e49 (Definition) \u4e00\u4e2a\u53d8\u91cf\u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u5728\u5408\u9002\u7684\u4f4d\u7f6e\u4e3a\u6211\u4eec\u5f00\u8f9f\u4e00\u5757\u5185\u5b58\u7a7a\u95f4\u3002</p> <p>\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf <code>a</code>\uff0c\u4e00\u4e2a <code>main</code> \u7684\u6808\u4e0a\u53d8\u91cf <code>b</code>\uff0c\u4e00\u4e2a <code>recursive</code> \u7684\u6808\u4e0a\u53d8\u91cf <code>c</code>\uff0c\u5e76\u6253\u5370\u5b83\u4eec\u7684\u5730\u5740\u3002</p> <pre><code>#include &lt;stdio.h&gt;\n\nint a = 0;\n\nvoid recursive(int depth) {\n    int c;\n    if (depth == 5) return;\n    printf(\"[%d] c is at: %p\\n\", depth, &amp;c);\n    recursive(depth + 1);\n}\n\nint main() {\n    int b;\n    printf(\"a is at: %p\\n\", &amp;a);\n    printf(\"b is at: %p\\n\", &amp;b);\n    recursive(0);\n}\n</code></pre> <p>\u6211\u4eec\u4f7f\u7528 <code>gcc -O0 -static a.c &amp;&amp; ./a.out</code> \u8fd0\u884c\u5b83\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>a is at: 0x4a0b10\nb is at: 0x7ffd1404c53c\n[0] c is at: 0x7ffd1404c51c\n[1] c is at: 0x7ffd1404c4ec\n[2] c is at: 0x7ffd1404c4bc\n[3] c is at: 0x7ffd1404c48c\n[4] c is at: 0x7ffd1404c45c\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c<code>a</code>\u7684\u5730\u5740\u662f <code>0x4a0b10</code> \uff0c\u800c <code>b</code> \u4e0e <code>c</code> \u7684\u5730\u5740\u662f\u4ee5 <code>0x7ffcc</code> \u5f00\u5934\u7684\u3002 \u5e76\u4e14\uff0c\u4e94\u4e2a <code>c</code> \u7684\u5730\u5740\u4e4b\u95f4\u5747\u76f8\u5dee\u56fa\u5b9a\u7684 <code>0x30</code>\u3002</p> <p>\u8fd9\u662f\u56e0\u4e3a\u7f16\u8bd1\u5668\u5c06 <code>a</code> \u653e\u7f6e\u5230\u4e86\u7a0b\u5e8f\u7684 <code>.data</code> \u6bb5\uff0c\u800c <code>b</code> \u4e0e <code>c</code> \u5219\u662f\u5728\u7a0b\u5e8f\u7684\u6808\u4e0a\u5206\u914d\u7684\u3002</p> <p>\u6211\u4eec\u901a\u8fc7 <code>objdump</code> \u5de5\u5177\u67e5\u770b\u7f16\u8bd1\u4ea7\u7269 <code>a.out</code> \u4e2d <code>main</code> \u7b26\u53f7\u7684\u6c47\u7f16\u4ee3\u7801\uff1a</p> <pre><code>$ llvm-objdump-16 --disassemble-symbols=main\n\na.out:  file format elf64-x86-64\n\nDisassembly of section .text:\n\n00000000004017f5 &lt;main&gt;:\n; int main() {\n  4017f5: 55                            push    rbp\n  4017f6: 48 89 e5                      mov     rbp, rsp\n;     printf(\"a is at: %p\\n\", &amp;a);\n  4017f9: 48 8d 05 10 f3 09 00          lea     rax, [rip + 0x9f310]    # 0x4a0b10 &lt;a&gt;\n  401800: 48 89 c6                      mov     rsi, rax\n  401803: 48 8d 05 18 18 07 00          lea     rax, [rip + 0x71818]    # 0x473022 &lt;dummy_bucket.6+0x1e&gt;\n  40180a: 48 89 c7                      mov     rdi, rax\n  40180d: b8 00 00 00 00                mov     eax, 0x0\n  401812: e8 e9 2d 00 00                call    0x404600 &lt;printf&gt;\n;     recursive(0);\n  401817: bf 00 00 00 00                mov     edi, 0x0\n  40181c: e8 94 ff ff ff                call    0x4017b5 &lt;recursive&gt;\n  401821: b8 00 00 00 00                mov     eax, 0x0\n; }\n  401826: 5d                            pop     rbp\n  401827: c3                            ret\n</code></pre> <p>\u8f93\u51fa\u7684\u7b2c\u4e00\u884c\u544a\u8bc9\u6211\u4eec <code>a.out</code> \u6587\u4ef6\u7684\u683c\u5f0f\u662f <code>elf64-x86-64</code>\uff0c\u8fd9\u4ee3\u8868\u8fd9\u662f\u4e00\u4e2a 64 \u4f4d ELF \u6587\u4ef6\uff0c\u67b6\u6784\u4e3a x86-64\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5728 <code>401816</code> \u548c <code>401831</code> \u5904\uff0c\u5206\u522b\u6709\u4e24\u6b21 <code>call    0x404620 &lt;printf&gt;</code>\uff0c\u8fd9\u4ee3\u8868\u8fd9\u8c03\u7528\u4e86 <code>printf</code> \u51fd\u6570\uff0c\u800c <code>printf</code> \u51fd\u6570\u5730\u5740\u4e3a <code>0x404620</code>\u3002</p> <pre><code>  4017fd: 48 8d 05 0c f3 09 00          lea     rax, [rip + 0x9f30c]    # 0x4a0b10 &lt;a&gt;\n  401804: 48 89 c6                      mov     rsi, rax\n  401807: 48 8d 05 14 18 07 00          lea     rax, [rip + 0x71814]    # 0x473022 &lt;dummy_bucket.6+0x1e&gt;\n  40180e: 48 89 c7                      mov     rdi, rax\n  401811: b8 00 00 00 00                mov     eax, 0x0\n  401816: e8 05 2e 00 00                call    0x404620 &lt;printf&gt;\n</code></pre> <p>\u6839\u636e <code>call</code> \u6307\u4ee4\u524d\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u6d4b\u5b9e\u9645\u8c03\u7528 <code>printf</code> \u65f6\u5bc4\u5b58\u5668\u503c\u3002\u5e76\u4e14\uff0c\u6839\u636e x86-64 \u67b6\u6784\u4e0b\u7684\u51fd\u6570\u8c03\u7528\u7ea6\u5b9a (Calling Convention, \u524d 6 \u4e2a\u6574\u6570\u53c2\u6570\u901a\u8fc7 rdi, rsi, rdx, rcx, r8, r9 \u4f20\u9012)\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u8c03\u7528 <code>printf</code> \u7684\u5177\u4f53\u53c2\u6570\uff1a</p> <pre><code>rdi:\n  401807: 48 8d 05 14 18 07 00          lea     rax, [rip + 0x71814]    # 0x473022 &lt;dummy_bucket.6+0x1e&gt;\n  40180e: 48 89 c7                      mov     rdi, rax\n\nrsi:\n  4017fd: 48 8d 05 0c f3 09 00          lea     rax, [rip + 0x9f30c]    # 0x4a0b10 &lt;a&gt;\n  401804: 48 89 c6                      mov     rsi, rax\n\n# printf(0x473022, 0x4a0b10)\n</code></pre> <p><code>lea</code> \u6307\u4ee4\u8868\u793a\u628a <code>rip</code> (\u5373\u5f53\u524d\u6307\u4ee4\u7684\u5730\u5740) \u52a0\u4e0a\u4e00\u4e2a\u7acb\u5373\u6570\uff0c\u7531\u4e8e\u8fd9\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u662f\u56fa\u5b9a\u7684\uff0c<code>objdump</code> \u5e2e\u6211\u4eec\u7b97\u51fa\u4e86\u8fd9\u4e2a\u5730\u5740\uff0c\u4e5f\u5c31\u662f\u53d8\u91cf a \u7684\u5730\u5740\u3002 \u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u7b2c\u4e00\u6b21 <code>printf</code> \u65f6\uff0c\u6253\u5370\u51fa\u6765\u7684\u5730\u5740\u662f\u4e00\u4e2a\u56fa\u5b9a\u7684\u6570 <code>0x4a0b10</code>\u3002</p> <p>\u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u89c2\u5bdf<code>main</code>\u4e2d\u7b2c\u4e8c\u6b21 <code>printf</code> \u8c03\u7528\uff0c\u4ee5\u53ca <code>recursive</code> \u4e2d\u7684 <code>printf</code> \u8c03\u7528\uff1a</p> <pre><code>main:\n  40181b: 48 8d 45 fc                   lea     rax, [rbp - 0x4]\n  40181f: 48 89 c6                      mov     rsi, rax\n...\n  401831: e8 ea 2d 00 00                call    0x404620 &lt;printf&gt;\n\nrecursive:\n  4017c6: 48 8d 55 fc                   lea     rdx, [rbp - 0x4]\n...\n  4017de: e8 3d 2e 00 00                call    0x404620 &lt;printf&gt;\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u540e\u7eed <code>printf</code> \u6253\u5370\u7684\u6307\u9488\u5747\u662f <code>[rbp - 0x4]</code>\uff0c\u8fd9\u4e2a\u503c\u5728\u516d\u6b21\u6253\u5370\u4e2d\u5747\u662f\u4e0d\u4e00\u81f4\u7684\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u53d8\u91cf\u88ab\u5206\u914d\u5728 <code>main</code> \u548c <code>recursive</code> \u51fd\u6570\u7684\u6808\u5e27 (Stack frame) \u4e0a\u3002</p> <p>\u5728\u6570\u636e\u7ed3\u6784\u8bfe\u548c\u8ba1\u7b97\u673a\u7ec4\u6210\u539f\u7406\u8bfe\u4e0a\uff0c\u6211\u4eec\u5b66\u4e60\u4e86\u6808 (stack) \u662f\u4e00\u79cd\u5148\u5165\u540e\u51fa (FILO) \u7684\u6570\u636e\u7ed3\u6784\uff0c\u6211\u4eec\u5bf9\u5b83\u7684\u64cd\u4f5c\u88ab\u79f0\u4e3a\u538b\u6808(push)\u548c\u5f39\u6808(pop)\uff0c\u5e76\u4e14\uff0c\u5b83\u662f\u5411\u4f4e\u5730\u5740\u751f\u957f\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u538b\u6808\u540e\u6808\u9876\u4f1a\u53d8\u5c0f\u3002</p> <p>\u5728\u8fdb\u5165\u548c\u79bb\u5f00 <code>main</code> \u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u6709\u4e00\u4e32\u6307\u4ee4\uff1a</p> <pre><code>main:\n  4017f5: 55                            push    rbp         # \u5c06 rbp \u5bc4\u5b58\u5668\u7684\u503c\u538b\u5165\u6808\u4e2d\n  4017f6: 48 89 e5                      mov     rbp, rsp    # \u5c06 rsp \u7684\u503c\u8d4b\u7ed9 rbp\n  4017f9: 48 83 ec 10                   sub     rsp, 0x10   # \u5c06 rsp \u51cf 0x10\n...\n  40181b: 48 8d 45 fc                   lea     rax, [rbp - 0x4]\n  40181f: 48 89 c6                      mov     rsi, rax\n...\n  401831: e8 ea 2d 00 00                call    0x404620 &lt;printf&gt;\n...\n  401845: c9                            leave               # \u5c06 rbp \u7684\u503c\u8d4b\u7ed9 rsp\uff1b\u5f39\u6808\uff0c\u5e76\u5c06\u503c\u8d4b\u7ed9 rbp\n  401846: c3                            ret                 # \u9000\u51fa\u51fd\u6570\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0 <code>push rbp</code>, <code>mov     rbp, rsp</code> \u4e0e <code>leave</code> \u5728\u8bed\u4e49\u4e0a\u5f62\u6210\u4e86\u76f8\u53cd\u7684\u4e00\u5bf9\u3002 \u5b9e\u9645\u4e0a\uff0c\u5b83\u4eec\u662f\u51fd\u6570\u7684 prologue \u548c epilogue\u3002 \u5206\u522b\u662f\u5728\u8fdb\u5165\u51fd\u6570\u65f6\u548c\u5728\u79bb\u5f00\u51fd\u6570\u65f6\u6267\u884c\u7684\u56fa\u5b9a\u4ee3\u7801\u7247\u6bb5\u3002 \u8fd9\u4e24\u6bb5\u7247\u6bb5\u6784\u5efa\u4e86\u5f53\u524d\u51fd\u6570\u7684\u6808\u5e27\uff08\u7c7b\u4f3c\u4e00\u5bf9\u538b\u6808\u548c\u5f39\u6808\u64cd\u4f5c\uff09\u3002</p> <p></p> <p>\u6211\u4eec\u7ed8\u5236\u8fd9\u51e0\u6761\u6307\u4ee4\u5bf9\u7a0b\u5e8f\u6808\u3001<code>rsp</code>\u5bc4\u5b58\u5668\u548c <code>rbp</code> \u5bc4\u5b58\u5668\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c<code>b</code> \u7684\u5b9e\u9645\u5730\u5740\u662f\u5728 saved rbp \u4e4b\u4e0a\uff0c\u6307\u5411 local variables \u533a\u57df\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u8fd9\u90e8\u5206\u662f\u7f16\u8bd1\u5668\u6839\u636e\u51fd\u6570\u5185\u5b9a\u4e49\u7684\u4e34\u65f6\u53d8\u91cf\u7684\u5927\u5c0f\u5728\u6808\u4e0a\u5f00\u8f9f\u7684\u7a7a\u95f4\u3002</p> <p>\u4e0e\u5728 <code>.data</code> \u6bb5\u7684\u53d8\u91cf <code>a</code> \u4e0d\u540c\uff0c\u8fd9\u4e9b\u4e34\u65f6\u53d8\u91cf\u7684\u5730\u5740\u5e76\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u4ed6\u4eec\u53ea\u5728\u8fd9\u4e2a\u6808\u5e27\u6709\u6548\u65f6\u662f\u5408\u6cd5\u7684\u3002</p> <p>Question</p> <p>int \u7c7b\u578b\u53ea\u5360 4 \u4e2a\u5b57\u8282\uff0c\u4e3a\u4ec0\u4e48 <code>sub rsp, 0x10</code> \u5f00\u8f9f\u4e86 16 \u4e2a\u5b57\u8282\u7684\u7a7a\u95f4\uff1f\u5728 x86-64 \u4e0a\u884c\u4e3a\u5982\u6b64\uff0c\u5728 RISC-V 64 \u4e0a\u5462\uff1f</p>"},{"location":"zh/lab/lab1/#_3","title":"\u7ed3\u6784\u4f53","text":"<p>C \u8bed\u8a00\u4e2d\uff0c\u7ed3\u6784\u4f53\u662f\u5bf9\u4e00\u8fde\u4e32\u6570\u636e\u7684\u8868\u793a\u3002 \u6211\u4eec\u901a\u8fc7 <code>struct</code> \u5173\u952e\u5b57\u8868\u793a\u8be5\u53d8\u91cf\u662f\u4e00\u4e2a\u7ed3\u6784\u4f53\u3002 \u901a\u5e38\uff0c\u6211\u4eec\u5c06\u4e00\u5806\u76f8\u5173\u8054\u7684\u6570\u636e\u653e\u7f6e\u5728\u540c\u4e00\u4e2a\u7ed3\u6784\u4f53\u4e0a\u3002</p> <pre><code>struct proc {\n    enum procstate state;   // Process state\n    int pid;                // Process ID\n    pagetable_t pagetable;  // User page table\n    uint64 ustack;          // Virtual address of kernel stack\n    uint64 kstack;          // Virtual address of kernel stack\n    struct trapframe *trapframe; // data page for trampoline.S\n    struct context context; // swtch() here to run process\n    struct proc *parent;    // Parent process\n};\n</code></pre> <p>\u5728\u6211\u4eec\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e0a\uff0c\u8fdb\u7a0b <code>struct proc</code> \u5305\u542b\u4e86 \u8fdb\u7a0b\u72b6\u6001 <code>state</code>\uff0cPID,\u9875\u8868\uff0c\u7528\u6237\u6808\u548c\u5185\u6838\u6808\u5730\u5740\u7b49\u4fe1\u606f\u3002</p> <p>\u5728\u5bf9\u7ed3\u6784\u4f53\u6307\u9488\u8bbf\u95ee\u5176\u6210\u5458\u53d8\u91cf\u65f6\uff0c\u6211\u4eec\u4f7f\u7528 <code>-&gt;</code> \u64cd\u4f5c\u7b26\u3002 \u5728\u5bf9\u7ed3\u6784\u4f53\u8bbf\u95ee\u5176\u6210\u5458\u53d8\u91cf\u65f6\uff0c\u6211\u4eec\u4f7f\u7528 <code>.</code> \u64cd\u4f5c\u7b26\u3002</p> <p>\u5728\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf <code>current_proc</code>\uff0c\u5b83\u662f\u4e00\u4e2a\u6307\u5411 <code>struct proc</code> \u7684\u6307\u9488\uff1b\u6211\u4eec\u4e5f\u5b9a\u4e49\u4e86\u4e00\u4e2a <code>idle</code> \u53d8\u91cf\uff0c\u5b83\u7684\u7c7b\u578b\u662f <code>struct proc</code>\u3002</p> <pre><code>struct proc *current_proc;\nstruct proc idle;\n\nvoid proc_init()\n{\n    current_proc = &amp;idle;\n}\n\nvoid yield()\n{\n    current_proc-&gt;state = RUNNABLE;\n    add_task(current_proc);\n    sched();\n}\n</code></pre> <p>Question</p> <p>\u8bf7\u4f60\u601d\u8003\u7f16\u8bd1\u5668\u4e3a <code>current_proc</code> \u548c <code>idle</code> \u53d8\u91cf\u5f00\u8f9f\u4e86\u591a\u5c11\u5b57\u8282\u7684\u7a7a\u95f4\uff0c\u8fd9\u4e00\u4e9b\u7a7a\u95f4\u662f\u5728\u54ea\u5f00\u8f9f\u7684\uff1f</p> <p>\u5728 <code>proc_init</code> \u521d\u59cb\u5316\u51fd\u6570\u4e2d\uff0c\u6211\u4eec\u5c06 <code>idle</code> \u7684\u5730\u5740\u8d4b\u4e88 <code>current_proc</code>\uff08<code>&amp;</code> \u662f\u53d6\u5730\u5740\u7b26\uff09\u3002\u6b64\u65f6\uff0c<code>current_proc</code> \u7684\u503c\u5373\u662f\u7f16\u8bd1\u5668\u4e3a <code>idle</code> \u53d8\u91cf\u5f00\u8f9f\u7684\u7a7a\u95f4\u7684\u8d77\u59cb\u5730\u5740\u3002</p> <p>Question</p> <p>\u4e3a\u4ec0\u4e48\u662f\u8d77\u59cb\u5730\u5740\uff1f</p> <p>\u6211\u4eec\u5728\u8ba1\u7b97\u673a\u7ec4\u6210\u539f\u7406\u8bfe\u7a0b\u4e0a\u5b66\u8fc7\uff0cRISC-V \u7684\u5bfb\u5740\u6a21\u5f0f (Addressing Mode) \u5305\u542b Base displacement addressing (\u57fa\u5730\u5740 + \u504f\u79fb\u91cf) \u6a21\u5f0f\u3002 \u56e0\u4e3a\u7ed3\u6784\u4f53\u4e2d\u67d0\u4e2a\u53d8\u91cf\u76f8\u5bf9\u4e8e\u7ed3\u6784\u4f53\u57fa\u5730\u5740\u7684\u504f\u79fb\u91cf\u662f\u5728\u7f16\u8bd1\u671f\u5df2\u77e5\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u67d0\u4e2a\u5bc4\u5b58\u5668\u4fdd\u5b58\u8be5\u7ed3\u6784\u4f53\u7684\u57fa\u5730\u5740\uff0c\u4f7f\u7528 ld/sw \u6307\u4ee4\u4e2d\u7684\u7acb\u5373\u6570\u504f\u79fb\u91cf\u8bbf\u95ee\u7ed3\u6784\u4f53\u4e2d\u7684\u6210\u5458\u53d8\u91cf\u3002</p> <pre><code>;       current_proc-&gt;state = RUNNABLE;\n802013b4: 97 b7 4b 00   auipc   a5, 1211\n802013b8: 93 87 c7 c5   addi    a5, a5, -932\n802013bc: 03 b7 07 00   ld      a4, 0(a5)\n802013c0: 93 06 30 00   li      a3, 3           # RUNNABLE = 3\n802013c4: 23 20 d7 00   sw      a3, 0(a4)\n</code></pre> <p>\u5df2\u77e5\u8fd9\u4e00\u4e32\u6c47\u7f16\u5b9e\u73b0\u7684\u662f <code>current_proc-&gt;state = RUNNABLE;</code> \u8bed\u53e5\uff0c\u5e76\u4e14 <code>state</code> \u76f8\u5bf9\u4e8e <code>struct proc</code> \u7684\u504f\u79fb\u91cf\u662f0\u3002 \u8bf7\u4f60\u89e3\u91ca <code>ld a4, 0(a5)</code> \u548c <code>sw a3, 0(a4)</code> \u4e2d a5 \u548c a4 \u7684\u503c\u5206\u522b\u6307\u5411\u54ea\u4e2a\u53d8\u91cf\u7684\u5730\u5740\uff0c\u5e76\u89e3\u91ca\u8fd9\u4e24\u53e5\u6c47\u7f16\u7684\u8bed\u4e49\u3002</p> <p>\u5982\u679c\u4f60\u7406\u89e3\u4e86\u8fd9\u4e24\u53e5\u6c47\u7f16\u7684\u610f\u601d\uff0c\u4f60\u5c31\u7406\u89e3\u4e86\u6307\u9488</p>"},{"location":"zh/lab/lab1/#_4","title":"\u7ed3\u6784\u4f53\u7684\u590d\u5236","text":"<pre><code>#include &lt;stdio.h&gt;\n\nstruct mystruct {\n    int a;\n    long b;\n};\n\nstruct mystruct s1;\n\nint main() {\n    s1.a = 114;\n    s1.b = 514;\n\n    struct mystruct *ptr = &amp;s1;\n\n    printf(\"ptr-&gt;a = %d\\n\", ptr-&gt;a);\n\n    struct mystruct onstack;\n    onstack = *ptr;\n\n    printf(\"onstack.b = %ld\\n\", onstack.b);\n}\n</code></pre> <p>Question</p> <p>\u8bf7\u4f60\u5728\u7535\u8111\u4e0a\u7f16\u8bd1\u5e76\u6267\u884c\u4ee5\u4e0a\u4ee3\u7801\uff0c\u5206\u6790 <code>s1</code>, <code>ptr</code> \u548c <code>onstack</code> \u5206\u522b\u5206\u914d\u5728\u54ea\u91cc\uff0c\u5176\u503c\u662f\u4ec0\u4e48\u3002</p>"},{"location":"zh/lab/lab1/#_5","title":"\u9759\u6001\u94fe\u63a5","text":""},{"location":"zh/qrh/nav/","title":"\u5feb\u901f\u53c2\u8003\u624b\u518c","text":"<p>\u672c\u624b\u518c\u4f1a\u8bb0\u5f55\u4f60\u5728\u8fdb\u884c\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u9a8c\u4e2d\u53ef\u80fd\u4f1a\u9047\u5230\u7684\u95ee\u9898\uff0c\u6216\u8005\u9700\u8981\u5b66\u4e60\u7684\u524d\u7f6e\u77e5\u8bc6</p> <ul> <li>GDB \u6559\u7a0b</li> </ul>"}]}